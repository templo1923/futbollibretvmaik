<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reproductor de Video</title>
  <style>
    body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background-color: #000; }
    video { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <video id="video" controls autoplay></video>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const video = document.getElementById('video');
      const params = new URLSearchParams(window.location.search);
      const m3u8UrlEncoded = params.get("src");

      if (m3u8UrlEncoded) {
        try {
          const m3u8Url = atob(m3u8UrlEncoded); // Decodificamos la URL
          
          if (Hls.isSupported()) {
            const hls = new Hls();
            hls.loadSource(m3u8Url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function () {
              video.play();
            });
          } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            // Soporte nativo en Safari
            video.src = m3u8Url;
            video.addEventListener('loadedmetadata', function () {
              video.play();
            });
          }
        } catch (e) {
          document.body.innerHTML = "<h2 style='color:white;text-align:center;'>URL inválida.</h2>";
        }
      } else {
        document.body.innerHTML = "<h2 style='color:white;text-align:center;'>No se encontró el video.</h2>";
      }
    });
  </script>
</body>
</html>
